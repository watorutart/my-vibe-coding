# AI Pet Buddy å®Ÿç¸¾ãƒ»çµ±è¨ˆã‚·ã‚¹ãƒ†ãƒ  æŠ€è¡“ä»•æ§˜æ›¸

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€AI Pet Buddyã®å®Ÿç¸¾ãƒ»çµ±è¨ˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆAchievement & Statistics Systemï¼‰ã®æŠ€è¡“ä»•æ§˜ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ãŠã‚ˆã³ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã«ã¤ã„ã¦è©³ç´°ã«èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆ](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆ)
3. [ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³](#ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³)
4. [ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°](#ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
6. [çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³](#çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³)
7. [APIä»•æ§˜](#apiä»•æ§˜)
8. [ä½¿ç”¨ä¾‹](#ä½¿ç”¨ä¾‹)

---

## ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

å®Ÿç¸¾ãƒ»çµ±è¨ˆã‚·ã‚¹ãƒ†ãƒ ã¯ã€AI Pet Buddyã«ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ ã‚’è¿½åŠ ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã®å‘ä¸Šã¨æ˜ç¢ºãªé€²æ—ç›®æ¨™ã‚’æä¾›ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

### ğŸ¯ ä¸»è¦æ©Ÿèƒ½

- **ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ **: 9ç¨®é¡ã®äº‹å‰å®šç¾©ã•ã‚ŒãŸãƒãƒƒã‚¸ã«ã‚ˆã‚‹é”æˆåº¦è¿½è·¡
- **ç§°å·ã‚·ã‚¹ãƒ†ãƒ **: 6ç¨®é¡ã®ç§°å·ã«ã‚ˆã‚‹ç†Ÿç·´åº¦è¡¨ç¤º
- **é€²æ—ç®¡ç†**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã®é€²æ—è¨ˆç®—ã¨é€šçŸ¥
- **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿**: ã‚²ãƒ¼ãƒ å±¥æ­´ã€ã‚±ã‚¢å±¥æ­´ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ±è¨ˆã®åŒ…æ‹¬çš„ãªè¨˜éŒ²
- **é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ **: å®Ÿç¸¾è§£é™¤æ™‚ã®å³åº§ã®é€šçŸ¥ã¨è¦–è¦šåŠ¹æœ
- **æ°¸ç¶šåŒ–**: localStorageåŸºç›¤ã®è‡ªå‹•ä¿å­˜æ©Ÿèƒ½

### ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
å®Ÿç¸¾ãƒ»çµ±è¨ˆã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ å‹å®šç¾©ãƒ¬ã‚¤ãƒ¤ãƒ¼ (Types)
â”‚   â”œâ”€â”€ Achievement.ts (57ãƒ†ã‚¹ãƒˆ)
â”‚   â”œâ”€â”€ Statistics.ts (42ãƒ†ã‚¹ãƒˆ)
â”‚   â””â”€â”€ Analytics.ts (19ãƒ†ã‚¹ãƒˆ)
â”œâ”€â”€ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ (Utils)
â”‚   â””â”€â”€ achievementEngine.ts (33ãƒ†ã‚¹ãƒˆ)
â”œâ”€â”€ çŠ¶æ…‹ç®¡ç†ãƒ¬ã‚¤ãƒ¤ãƒ¼ (Hooks)
â”‚   â””â”€â”€ useAchievements.ts
â””â”€â”€ è¡¨ç¤ºãƒ¬ã‚¤ãƒ¤ãƒ¼ (Components)
    â”œâ”€â”€ BadgeDisplay.tsx (39ãƒ†ã‚¹ãƒˆ)
    â””â”€â”€ BadgeDisplay.css
```

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆ

### ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```mermaid
graph TB
    subgraph "UI Layer"
        BD[BadgeDisplay Component]
        AS[Achievement Screen]
        PN[Progress Notifications]
    end
    
    subgraph "State Management Layer"
        UA[useAchievements Hook]
        LS[localStorage Persistence]
    end
    
    subgraph "Business Logic Layer"
        AE[Achievement Engine]
        PC[Progress Calculator]
        AC[Achievement Checker]
    end
    
    subgraph "Data Layer"
        AT[Achievement Types]
        ST[Statistics Types]
        AN[Analytics Types]
        PB[Predefined Badges]
        PT[Predefined Titles]
    end
    
    subgraph "Integration Points"
        GM[Game Module]
        PM[Pet Module]
        CM[Care Module]
        EM[Evolution Module]
    end
    
    AS --> BD
    AS --> UA
    BD --> UA
    UA --> AE
    UA --> LS
    AE --> PC
    AE --> AC
    AE --> AT
    AE --> ST
    PC --> PB
    PC --> PT
    AC --> AN
    
    GM --> UA
    PM --> UA
    CM --> UA
    EM --> UA
```

### è²¬ä»»åˆ†æ•£ãƒ‘ã‚¿ãƒ¼ãƒ³

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | è²¬ä»» | ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
|---------|------|------------------|
| **UI Layer** | è¡¨ç¤ºãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ | BadgeDisplay, Notifications |
| **State Management** | çŠ¶æ…‹ç®¡ç†ãƒ»æ°¸ç¶šåŒ– | useAchievements Hook |
| **Business Logic** | å®Ÿç¸¾ãƒã‚§ãƒƒã‚¯ãƒ»é€²æ—è¨ˆç®— | achievementEngine |
| **Data Layer** | å‹å®šç¾©ãƒ»è¨­å®šãƒ‡ãƒ¼ã‚¿ | Types, Predefined Data |

---

## ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³

### 1. å®Ÿç¸¾ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant U as User
    participant AS as Achievement Screen
    participant UA as useAchievements Hook
    participant LS as localStorage
    participant AE as Achievement Engine
    participant AT as Achievement Types

    Note over U,AT: ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
    U->>AS: ã‚¢ãƒ—ãƒªèµ·å‹•/ç”»é¢é·ç§»
    AS->>UA: useAchievements(pet)
    UA->>LS: loadAchievementData()
    
    alt ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹å ´åˆ
        LS-->>UA: return saved data
        UA->>AE: validateAndMigrateData(data)
        AE-->>UA: return validated data
    else ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„å ´åˆ
        UA->>AE: initializeAchievementState(pet)
        AE->>AT: PREDEFINED_BADGES
        AE->>AT: PREDEFINED_TITLES
        AE->>AT: DEFAULT_ACHIEVEMENT_PROGRESS
        AT-->>AE: return default data
        AE-->>UA: return initialized state
    end
    
    UA-->>AS: achievementState ready
    AS->>AS: renderAchievements()
    
    Note over U,AT: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†
    UA->>UA: startSessionTracking()
    UA->>LS: scheduleAutoSave()
```

### 2. ã‚²ãƒ¼ãƒ çµæœã«ã‚ˆã‚‹å®Ÿç¸¾æ›´æ–°ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant G as Game Component
    participant UA as useAchievements Hook
    participant AE as Achievement Engine
    participant PC as Progress Calculator
    participant NS as Notification System
    participant BD as BadgeDisplay
    
    Note over G,BD: ã‚²ãƒ¼ãƒ å®Œäº†æ™‚ã®å®Ÿç¸¾æ›´æ–°
    G->>UA: recordGameResult(gameData)
    UA->>AE: updateGameProgress(gameData, currentState)
    
    AE->>PC: calculateWinStreak(gameData)
    PC-->>AE: return streak count
    AE->>PC: calculateTotalGames(gameData)  
    PC-->>AE: return total count
    
    loop å„ãƒãƒƒã‚¸ã‚’ãƒã‚§ãƒƒã‚¯
        AE->>AE: checkBadgeRequirement(badge, progress)
        alt ãƒãƒƒã‚¸è§£é™¤æ¡ä»¶é”æˆ
            AE->>AE: unlockBadge(badge)
            AE->>NS: createNotification(badge)
        end
    end
    
    loop å„ç§°å·ã‚’ãƒã‚§ãƒƒã‚¯
        AE->>AE: checkTitleRequirement(title, progress)
        alt ç§°å·è§£é™¤æ¡ä»¶é”æˆ
            AE->>AE: unlockTitle(title)
            AE->>NS: createNotification(title)
        end
    end
    
    AE-->>UA: return updated state + notifications
    UA->>UA: saveToLocalStorage()
    UA-->>G: operation completed
    
    Note over G,BD: UIæ›´æ–°
    UA->>BD: trigger re-render (updated badges)
    BD->>BD: show unlock animations
    UA->>NS: show notifications
```

### 3. ãƒšãƒƒãƒˆé€²åŒ–ã«ã‚ˆã‚‹å®Ÿç¸¾æ›´æ–°ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant EM as Evolution Module
    participant UA as useAchievements Hook
    participant AE as Achievement Engine
    participant PC as Progress Calculator
    participant BD as BadgeDisplay
    participant PN as Push Notification
    
    Note over EM,PN: ãƒšãƒƒãƒˆé€²åŒ–æ™‚ã®å®Ÿç¸¾å‡¦ç†
    EM->>UA: recordEvolution(evolutionData)
    UA->>AE: updateEvolutionProgress(evolutionData, state)
    
    AE->>PC: calculateEvolutionCount(data)
    PC-->>AE: return evolution count
    
    AE->>AE: checkEvolutionBadges(count)
    alt "First Evolution" ãƒãƒƒã‚¸æ¡ä»¶
        AE->>AE: unlockBadge("first-evolution")
        AE->>PN: createNotification("ğŸŒŸ First Evolution")
    end
    
    alt "Evolution Master" ãƒãƒƒã‚¸æ¡ä»¶ (5+ evolutions)
        AE->>AE: unlockBadge("evolution-master")  
        AE->>PN: createNotification("ğŸ¦‹ Evolution Master")
    end
    
    AE->>AE: checkEvolutionTitles(count)
    alt "Evolution Expert" ç§°å·æ¡ä»¶
        AE->>AE: unlockTitle("evolution-expert")
        AE->>PN: createNotification("ç§°å·ç²å¾—: Evolution Expert")
    end
    
    AE-->>UA: return updated achievement state
    UA->>UA: persistToStorage()
    UA-->>EM: evolution recorded
    
    Note over EM,PN: UIåæ˜ 
    UA->>BD: update badge displays
    BD->>BD: show sparkle effects
    UA->>PN: display notifications
```

### 4. çµ±è¨ˆãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»è¡¨ç¤ºãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant US as User
    participant SS as Statistics Screen
    participant UA as useAchievements Hook
    participant AE as Achievement Engine
    participant SA as Statistics Analyzer
    participant CD as Chart Display
    
    Note over US,CD: çµ±è¨ˆç”»é¢è¡¨ç¤º
    US->>SS: çµ±è¨ˆç”»é¢ã‚’é–‹ã
    SS->>UA: getSummary()
    UA->>AE: getAchievementSummary(state)
    
    AE->>SA: analyzeGameStats(statistics)
    SA-->>AE: return game analysis
    AE->>SA: analyzeCareStats(statistics)
    SA-->>AE: return care analysis
    AE->>SA: analyzeSessionStats(statistics)
    SA-->>AE: return session analysis
    
    AE-->>UA: return complete summary
    UA-->>SS: statistics ready
    
    SS->>CD: renderCharts(summary)
    CD->>CD: generateGameChart()
    CD->>CD: generateProgressChart()
    CD->>CD: generateTimeChart()
    CD-->>SS: charts rendered
    
    Note over US,CD: æ¬¡ã®å®Ÿç¸¾è¡¨ç¤º
    SS->>UA: getNextAchievements()
    UA->>AE: getNextAchievements(state)
    AE->>AE: calculateClosestBadges()
    AE->>AE: calculateRecommendedActions()
    AE-->>UA: return recommendations
    UA-->>SS: next achievements ready
    SS->>SS: displayRecommendations()
```

### 5. ã‚»ãƒƒã‚·ãƒ§ãƒ³è¿½è·¡ãƒ»è‡ªå‹•ä¿å­˜ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant U as User
    participant APP as App Component
    participant UA as useAchievements Hook
    participant ST as Session Tracker
    participant AS as Auto Saver
    participant LS as localStorage
    
    Note over U,LS: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã¨ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
    U->>APP: ã‚¢ãƒ—ãƒªé–‹å§‹
    APP->>UA: useAchievements() with enableSessionTracking
    UA->>ST: startSession()
    ST->>ST: sessionStartTime = now()
    
    UA->>AS: scheduleAutoSave(interval: 30s)
    
    loop ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œä¸­
        U->>APP: æ“ä½œï¼ˆã‚²ãƒ¼ãƒ ã€ã‚±ã‚¢ã€ç­‰ï¼‰
        APP->>UA: å„ç¨®record*() ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—
        UA->>UA: updateInternalState()
        
        Note over UA,LS: å®šæœŸè‡ªå‹•ä¿å­˜
        AS->>AS: saveInterval elapsed
        AS->>LS: saveAchievementState(currentState)
        LS-->>AS: save completed
    end
    
    Note over U,LS: ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†
    U->>APP: ã‚¢ãƒ—ãƒªçµ‚äº†/éã‚¢ã‚¯ãƒ†ã‚£ãƒ–
    APP->>UA: cleanup/unmount
    UA->>ST: endSession()
    ST->>ST: calculate session duration
    ST->>UA: recordSessionData(duration, actions)
    UA->>UA: updateSessionStats()
    UA->>LS: finalSave()
    LS-->>UA: final save completed
```

---

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

### ğŸ¯ Achievement Engine (achievementEngine.ts)

å®Ÿç¸¾ã‚·ã‚¹ãƒ†ãƒ ã®æ ¸ã¨ãªã‚‹ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æä¾›ã—ã¾ã™ã€‚

#### ä¸»è¦æ©Ÿèƒ½
- **é€²æ—è¨ˆç®—**: ã‚²ãƒ¼ãƒ çµæœã€ã‚±ã‚¢è¡Œå‹•ã€é€²åŒ–ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãé€²æ—æ›´æ–°
- **å®Ÿç¸¾ãƒã‚§ãƒƒã‚¯**: ãƒãƒƒã‚¸ãƒ»ç§°å·ã®è§£é™¤æ¡ä»¶ã‚’è‡ªå‹•ãƒã‚§ãƒƒã‚¯
- **é€šçŸ¥ç”Ÿæˆ**: å®Ÿç¸¾è§£é™¤æ™‚ã®é€šçŸ¥ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
- **ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼**: ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

#### ã‚³ã‚¢ãƒ¡ã‚½ãƒƒãƒ‰

```typescript
// å®Ÿç¸¾çŠ¶æ…‹ã®åˆæœŸåŒ–
export function initializeAchievementState(pet: Pet): AchievementState

// ã‚²ãƒ¼ãƒ çµæœã«ã‚ˆã‚‹é€²æ—æ›´æ–°
export function updateGameProgress(
  gameData: GameData, 
  currentState: AchievementState
): AchievementState

// å®Ÿç¸¾ãƒã‚§ãƒƒã‚¯ã¨é€šçŸ¥ç”Ÿæˆ
export function checkAchievements(
  state: AchievementState, 
  progress: AchievementProgress
): AchievementNotification[]
```

### ğŸ£ useAchievements Hook

ReactçŠ¶æ…‹ç®¡ç†ã¨æ°¸ç¶šåŒ–ã‚’æ‹…å½“ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã€‚

#### æ©Ÿèƒ½
- **çŠ¶æ…‹ç®¡ç†**: å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿ã®ä¸€å…ƒç®¡ç†
- **è‡ªå‹•ä¿å­˜**: configurable intervalã§ã®è‡ªå‹•ä¿å­˜
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: localStorageä¾‹å¤–ã®å‡¦ç†
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³è¿½è·¡**: ãƒ—ãƒ¬ã‚¤æ™‚é–“ã¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¨˜éŒ²

#### Interface

```typescript
interface UseAchievementsReturn {
  // State
  achievementState: AchievementState;
  notifications: AchievementNotification[];
  isLoading: boolean;
  error: string | null;
  
  // Actions
  recordGameResult: (gameData: GameData) => void;
  recordEvolution: (evolutionData: EvolutionData) => void;
  recordCareAction: (careData: CareActionData) => void;
  activateTitle: (titleId: string) => void;
  dismissNotification: (notificationId: string) => void;
  
  // Queries
  getSummary: () => AchievementSummary;
  getNextAchievements: () => Badge[];
}
```

### ğŸ… BadgeDisplay Component

å€‹åˆ¥ãƒãƒƒã‚¸ã®è¡¨ç¤ºã‚’æ‹…å½“ã™ã‚‹Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€‚

#### è¦–è¦šç‰¹å¾´
- **ãƒ¬ã‚¢ãƒªãƒ†ã‚£ãƒ™ãƒ¼ã‚¹**: Common(ç·‘), Rare(é’), Epic(ç´«), Legendary(é‡‘)
- **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: è§£é™¤æ™‚ã®ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ«åŠ¹æœã€ã‚·ãƒ£ã‚¤ãƒ³åŠ¹æœ
- **é€²æ—è¡¨ç¤º**: æœªè§£é™¤ãƒãƒƒã‚¸ã®é€²æ—ãƒãƒ¼
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–**: multiple size variants (small/medium/large)

#### Props Interface

```typescript
interface BadgeDisplayProps {
  badge: Badge;
  size?: 'small' | 'medium' | 'large';
  showProgress?: boolean;
  showDescription?: boolean;
  onClick?: (badge: Badge) => void;
  className?: string;
}
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œ

```mermaid
flowchart TD
    A[User Action] --> B{Action Type}
    
    B -->|Game| C[recordGameResult]
    B -->|Evolution| D[recordEvolution]  
    B -->|Care| E[recordCareAction]
    B -->|Level Up| F[recordLevelChange]
    
    C --> G[updateGameProgress]
    D --> H[updateEvolutionProgress]
    E --> I[updateCareProgress]
    F --> J[updateLevelProgress]
    
    G --> K[checkAchievements]
    H --> K
    I --> K  
    J --> K
    
    K --> L{New Achievement?}
    L -->|Yes| M[Create Notification]
    L -->|No| N[Update Progress Only]
    
    M --> O[Update UI State]
    N --> O
    O --> P[Auto Save to localStorage]
    
    P --> Q[Re-render Components]
    Q --> R[Show Animations/Effects]
```

### æ°¸ç¶šåŒ–ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

```json
{
  "ai-pet-buddy-achievements": {
    "badges": [
      {
        "id": "first-evolution",
        "unlocked": true,
        "unlockedAt": 1699123456789,
        "progress": 1.0
      }
    ],
    "titles": [
      {
        "id": "beginner-trainer", 
        "unlocked": true,
        "active": true,
        "unlockedAt": 1699123456789
      }
    ],
    "statistics": {
      "games": {
        "totalGames": 25,
        "wins": 18,
        "winStreak": 5,
        "maxWinStreak": 8
      },
      "care": {
        "totalActions": 45,
        "consecutiveDays": 7,
        "maxConsecutiveDays": 12
      }
    },
    "progress": {
      "evolutionCount": 3,
      "maxLevel": 15,
      "totalPlaytime": 7200000
    }
  }
}
```

---

## çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆ

#### 1. ã‚²ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ

```typescript
// MiniGamePanel.tsx ã§ã®çµ±åˆä¾‹
const MiniGamePanel = () => {
  const { recordGameResult } = useAchievements(pet);
  const { gameState, submitAnswer } = useGame();
  
  const handleGameComplete = (result: GameResult) => {
    // æ—¢å­˜ã®ã‚²ãƒ¼ãƒ å‡¦ç†
    const gameSession = gameState.currentSession;
    
    // å®Ÿç¸¾ã‚·ã‚¹ãƒ†ãƒ ã«çµæœã‚’è¨˜éŒ²
    recordGameResult({
      type: gameSession.type,
      result: result.outcome,
      timestamp: Date.now(),
      duration: result.duration
    });
  };
  
  return (
    // ã‚²ãƒ¼ãƒ UI
  );
};
```

#### 2. ãƒšãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ çµ±åˆ

```typescript
// App.tsx ã§ã®çµ±åˆä¾‹
const App = () => {
  const [pet, setPet] = useState<Pet>(defaultPet);
  const { recordEvolution, recordCareAction } = useAchievements(pet);
  
  const handleEvolution = (newPet: Pet) => {
    setPet(newPet);
    
    // å®Ÿç¸¾ã‚·ã‚¹ãƒ†ãƒ ã«é€²åŒ–ã‚’è¨˜éŒ²
    recordEvolution({
      fromLevel: pet.level,
      toLevel: newPet.level,
      fromStage: pet.evolutionStage,
      toStage: newPet.evolutionStage,
      timestamp: Date.now()
    });
  };
  
  return (
    <div>
      <PetDisplay pet={pet} />
      <AchievementDisplay />
    </div>
  );
};
```

#### 3. é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ

```typescript
// é€šçŸ¥ã®è¡¨ç¤ºçµ±åˆ
const AchievementNotifications = () => {
  const { notifications, dismissNotification } = useAchievements(pet);
  
  return (
    <div className="notifications">
      {notifications.map(notification => (
        <div key={notification.id} className="achievement-notification">
          <span>{notification.message}</span>
          <button onClick={() => dismissNotification(notification.id)}>
            Ã—
          </button>
        </div>
      ))}
    </div>
  );
};
```

---

## APIä»•æ§˜

### Types API

#### Achievement Types

```typescript
// ãƒãƒƒã‚¸å®šç¾©
interface Badge {
  id: string;
  name: string;
  description: string;
  icon: string;
  category: AchievementCategory;
  rarity: AchievementRarity;
  requirements: AchievementRequirement;
  unlocked: boolean;
  unlockedAt?: number;
  progress: number; // 0-1
}

// ç§°å·å®šç¾©
interface Title {
  id: string;
  name: string;
  description: string;
  icon: string;
  category: AchievementCategory;
  rarity: AchievementRarity;
  requirements: AchievementRequirement;
  unlocked: boolean;
  unlockedAt?: number;
  active: boolean;
}

// å®Ÿç¸¾è¦æ±‚æ¡ä»¶
interface AchievementRequirement {
  type: 'evolution_count' | 'game_win_streak' | 'consecutive_days' | 'level_reached' | 'stat_max' | 'total_games' | 'total_playtime';
  value: number;
  description: string;
}
```

#### Statistics Types

```typescript
// ã‚²ãƒ¼ãƒ çµ±è¨ˆ
interface GameStatistics {
  totalGames: number;
  wins: number;
  losses: number;
  draws: number;
  winRate: number;
  winStreak: number;
  maxWinStreak: number;
  averageGameDuration: number;
  gameHistory: GameRecord[];
  gameTypeStats: GameTypeStatistics;
}

// ã‚±ã‚¢çµ±è¨ˆ
interface CareStatistics {
  totalActions: number;
  feedingActions: number;
  playingActions: number;
  restingActions: number;
  consecutiveDays: number;
  maxConsecutiveDays: number;
  careHistory: CareRecord[];
  dailyCareStats: DailyCareStatistics;
}
```

### Engine API

#### Core Functions

```typescript
// å®Ÿç¸¾çŠ¶æ…‹åˆæœŸåŒ–
function initializeAchievementState(pet: Pet): AchievementState;

// é€²æ—æ›´æ–°é–¢æ•°ç¾¤
function updateGameProgress(gameData: GameData, state: AchievementState): AchievementState;
function updateEvolutionProgress(evolutionData: EvolutionData, state: AchievementState): AchievementState;
function updateCareProgress(careData: CareActionData, state: AchievementState): AchievementState;
function updateLevelProgress(levelData: LevelData, state: AchievementState): AchievementState;

// å®Ÿç¸¾ãƒã‚§ãƒƒã‚¯
function checkAchievements(state: AchievementState, progress: AchievementProgress): AchievementNotification[];

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
function activateTitle(titleId: string, state: AchievementState): AchievementState;
function getAchievementSummary(state: AchievementState): AchievementSummary;
function getNextAchievements(state: AchievementState): Badge[];
```

### Hook API

#### useAchievements Hook

```typescript
function useAchievements(
  pet: Pet, 
  options?: UseAchievementsOptions
): UseAchievementsReturn;

interface UseAchievementsOptions {
  autoSave?: boolean;           // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: true
  saveInterval?: number;        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30000ms
  maxNotifications?: number;    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5
  enableSessionTracking?: boolean; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: true
}
```

---

## ä½¿ç”¨ä¾‹

### åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹

```tsx
import { useAchievements } from './hooks/useAchievements';
import BadgeDisplay from './components/BadgeDisplay';

function AchievementScreen({ pet }: { pet: Pet }) {
  const {
    achievementState,
    notifications,
    recordGameResult,
    recordEvolution,
    getSummary,
    getNextAchievements
  } = useAchievements(pet);

  // ã‚²ãƒ¼ãƒ å‹åˆ©æ™‚ã®å‡¦ç†
  const handleGameWin = () => {
    recordGameResult({
      type: 'rock-paper-scissors',
      result: 'win',
      timestamp: Date.now(),
      duration: 30
    });
  };

  // é€²åŒ–æ™‚ã®å‡¦ç†
  const handleEvolution = () => {
    recordEvolution({
      fromLevel: pet.level,
      toLevel: pet.level + 1,
      fromStage: pet.evolutionStage,
      toStage: pet.evolutionStage + 1,
      timestamp: Date.now()
    });
  };

  const summary = getSummary();
  const nextAchievements = getNextAchievements();

  return (
    <div className="achievement-screen">
      <h1>å®Ÿç¸¾ä¸€è¦§</h1>
      
      {/* ãƒãƒƒã‚¸è¡¨ç¤º */}
      <div className="badges-grid">
        {achievementState.badges.map(badge => (
          <BadgeDisplay 
            key={badge.id} 
            badge={badge}
            size="medium"
            onClick={(badge) => showBadgeDetails(badge)}
          />
        ))}
      </div>

      {/* çµ±è¨ˆã‚µãƒãƒªãƒ¼ */}
      <div className="summary">
        <h2>çµ±è¨ˆ</h2>
        <p>ç·ã‚²ãƒ¼ãƒ æ•°: {summary.totalGames}</p>
        <p>å‹ç‡: {(summary.winRate * 100).toFixed(1)}%</p>
        <p>è§£é™¤æ¸ˆã¿ãƒãƒƒã‚¸: {summary.unlockedBadges}/{summary.totalBadges}</p>
      </div>

      {/* æ¬¡ã®å®Ÿç¸¾ */}
      <div className="next-achievements">
        <h2>æ¬¡ã®å®Ÿç¸¾</h2>
        {nextAchievements.slice(0, 3).map(badge => (
          <BadgeDisplay 
            key={badge.id}
            badge={badge}
            size="small"
            showProgress={true}
          />
        ))}
      </div>

      {/* é€šçŸ¥ */}
      {notifications.map(notification => (
        <div key={notification.id} className="notification">
          {notification.message}
        </div>
      ))}
    </div>
  );
}
```

### é«˜åº¦ãªçµ±åˆä¾‹

```tsx
// ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®çµ±åˆ
function RockPaperScissorsGame({ pet }: { pet: Pet }) {
  const [gameState, setGameState] = useState<GameState>('waiting');
  const { recordGameResult } = useAchievements(pet);
  
  const playGame = async (playerChoice: Choice) => {
    const startTime = Date.now();
    setGameState('playing');
    
    // ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè¡Œ
    const result = await executeGame(playerChoice);
    const duration = (Date.now() - startTime) / 1000;
    
    // çµæœã‚’ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã«åæ˜ 
    setGameState('finished');
    
    // å®Ÿç¸¾ã‚·ã‚¹ãƒ†ãƒ ã«è¨˜éŒ²
    recordGameResult({
      type: 'rock-paper-scissors',
      result: result.outcome,
      timestamp: startTime,
      duration: duration
    });
  };

  return (
    <div className="rps-game">
      {/* ã‚²ãƒ¼ãƒ UI */}
    </div>
  );
}

// çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ä½¿ç”¨
function StatisticsDashboard({ pet }: { pet: Pet }) {
  const { getSummary, achievementState } = useAchievements(pet);
  const summary = getSummary();
  
  return (
    <div className="stats-dashboard">
      <div className="charts">
        <Chart 
          type="doughnut"
          data={{
            labels: ['å‹åˆ©', 'æ•—åŒ—', 'å¼•ãåˆ†ã‘'],
            datasets: [{
              data: [summary.wins, summary.losses, summary.draws],
              backgroundColor: ['#10b981', '#ef4444', '#6b7280']
            }]
          }}
        />
      </div>
      
      <div className="progress-overview">
        {achievementState.badges.map(badge => (
          <div key={badge.id} className="progress-item">
            <span>{badge.name}</span>
            <div className="progress-bar">
              <div 
                className="progress-fill"
                style={{ width: `${badge.progress * 100}%` }}
              />
            </div>
            <span>{(badge.progress * 100).toFixed(0)}%</span>
          </div>
        ))}
      </div>
    </div>
  );
}
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆä»•æ§˜

### ãƒ†ã‚¹ãƒˆæ§‹æˆ

- **å‹å®šç¾©ãƒ†ã‚¹ãƒˆ**: 118ãƒ†ã‚¹ãƒˆ (Achievement: 57, Statistics: 42, Analytics: 19)
- **ã‚¨ãƒ³ã‚¸ãƒ³ãƒ†ã‚¹ãƒˆ**: 33ãƒ†ã‚¹ãƒˆ (achievementEngine.ts)
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ**: 39ãƒ†ã‚¹ãƒˆ (BadgeDisplay.tsx)
- **åˆè¨ˆ**: 190ãƒ†ã‚¹ãƒˆ

### ä¸»è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

#### å®Ÿç¸¾ã‚¨ãƒ³ã‚¸ãƒ³ãƒ†ã‚¹ãƒˆ
- åˆæœŸåŒ–å‡¦ç†ã®æ¤œè¨¼
- å„ç¨®é€²æ—æ›´æ–°ã®æ¤œè¨¼
- ãƒãƒƒã‚¸ãƒ»ç§°å·è§£é™¤æ¡ä»¶ã®æ¤œè¨¼
- é€šçŸ¥ç”Ÿæˆã®æ¤œè¨¼
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ¤œè¨¼

#### ãƒãƒƒã‚¸è¡¨ç¤ºãƒ†ã‚¹ãƒˆ
- å„ãƒ¬ã‚¢ãƒªãƒ†ã‚£ã®è¡¨ç¤ºæ¤œè¨¼
- é€²æ—è¡¨ç¤ºã®æ¤œè¨¼
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã®æ¤œè¨¼
- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã®æ¤œè¨¼
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®æ¤œè¨¼

---

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### è¨ˆç®—åŠ¹ç‡åŒ–
- é€²æ—è¨ˆç®—ã®ãƒ¡ãƒ¢åŒ–
- ä¸è¦ãªå®Ÿç¸¾ãƒã‚§ãƒƒã‚¯ã®ã‚¹ã‚­ãƒƒãƒ—
- ãƒãƒƒãƒæ›´æ–°ã«ã‚ˆã‚‹æç”»æœ€é©åŒ–

### ãƒ¡ãƒ¢ãƒªç®¡ç†
- é€šçŸ¥å±¥æ­´ã®è‡ªå‹•å‰Šé™¤
- çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®åœ§ç¸®ä¿å­˜
- æœªä½¿ç”¨ãƒ‡ãƒ¼ã‚¿ã®å®šæœŸã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### æ°¸ç¶šåŒ–æœ€é©åŒ–
- å·®åˆ†æ›´æ–°ã«ã‚ˆã‚‹ä¿å­˜é‡å‰Šæ¸›
- è‡ªå‹•ä¿å­˜é–“éš”ã®èª¿æ•´
- ã‚¨ãƒ©ãƒ¼å›å¾©æ©Ÿèƒ½

---

## ğŸ“ˆ ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

### Phase 5ä»¥é™ã®æ©Ÿèƒ½æ‹¡å¼µ
- Chart.jsã«ã‚ˆã‚‹è©³ç´°çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- ã‚½ãƒ¼ã‚·ãƒ£ãƒ«æ©Ÿèƒ½ï¼ˆå®Ÿç¸¾å…±æœ‰ï¼‰
- ã‚¢ãƒ‰ãƒãƒ³ã‚¹ãƒ‰åˆ†ææ©Ÿèƒ½
- å­£ç¯€é™å®šå®Ÿç¸¾ã‚·ã‚¹ãƒ†ãƒ 

### æŠ€è¡“çš„æ”¹å–„é …ç›®
- WebWorkerã«ã‚ˆã‚‹ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†
- IndexedDBã¸ã®ç§»è¡Œæ¤œè¨
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸæ©Ÿèƒ½
- PWAçµ±åˆã«ã‚ˆã‚‹ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ AI Pet Buddy Phase 4 å®Ÿè£… (2024å¹´) ã«åŸºã¥ã„ã¦ä½œæˆã•ã‚Œã¾ã—ãŸã€‚*
*æœ€æ–°æƒ…å ±ã«ã¤ã„ã¦ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’ã”ç¢ºèªãã ã•ã„ã€‚*