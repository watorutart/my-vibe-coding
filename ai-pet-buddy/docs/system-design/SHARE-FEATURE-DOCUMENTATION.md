# AI Pet Buddy ã‚·ã‚§ã‚¢æ©Ÿèƒ½ å®Œå…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€AI Pet Buddyã®ã‚·ã‚§ã‚¢æ©Ÿèƒ½ã®è©³ç´°ãªä»•æ§˜ã€å®Ÿè£…ã€ä½¿ç”¨æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

1. [æ©Ÿèƒ½æ¦‚è¦](#æ©Ÿèƒ½æ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [å®Ÿè£…è©³ç´°](#å®Ÿè£…è©³ç´°)
4. [APIä»•æ§˜](#apiä»•æ§˜)
5. [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
6. [ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°](#ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°)
7. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹)
8. [ä»Šå¾Œã®æ‹¡å¼µ](#ä»Šå¾Œã®æ‹¡å¼µ)

## ğŸ¯ æ©Ÿèƒ½æ¦‚è¦

AI Pet Buddyã®ã‚·ã‚§ã‚¢æ©Ÿèƒ½ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒƒãƒˆã®æˆé•·ã‚„çŠ¶æ…‹ã‚’ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å…±æœ‰ã§ãã‚‹åŒ…æ‹¬çš„ãªã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

### ä¸»è¦æ©Ÿèƒ½

#### 1. ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±
- **é«˜å“è³ªç”»åƒç”Ÿæˆ**: html2canvasã‚’ä½¿ç”¨ã—ãŸ1080x1080pxã®æ­£æ–¹å½¢ç”»åƒ
- **ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½è¨­å®š**: è§£åƒåº¦ã€å“è³ªã€èƒŒæ™¯è‰²ã®èª¿æ•´
- **ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯**: ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ç”¨ã®é€æ˜ãƒ­ã‚´æŒ¿å…¥
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¯¾å¿œ**: PNGã€JPEGã€WebPå½¢å¼ã§ã®å‡ºåŠ›

#### 2. çµ±è¨ˆã‚«ãƒ¼ãƒ‰ç”Ÿæˆ
- **å‹•çš„ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º**: ãƒšãƒƒãƒˆãƒ¬ãƒ™ãƒ«ã€é€²åŒ–æ®µéšã€ãƒ—ãƒ¬ã‚¤æ™‚é–“ã€å®Ÿç¸¾
- **ç¾ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³**: ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ã¨ã‚¬ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ åŠ¹æœ
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–**: æ§˜ã€…ãªç”»é¢ã‚µã‚¤ã‚ºã«å¯¾å¿œã—ãŸãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- **ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°**: ä¸€è²«ã—ãŸAI Pet Buddyãƒ‡ã‚¶ã‚¤ãƒ³

#### 3. SNSã‚·ã‚§ã‚¢çµ±åˆ
- **ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: Twitterã€Facebookã€Instagramã€LINEå¯¾å¿œ
- **æœ€é©åŒ–ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ**: ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥æ–‡å­—æ•°åˆ¶é™å¯¾å¿œ
- **ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ç®¡ç†**: è‡ªå‹•ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ä»˜ä¸ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- **URLç”Ÿæˆ**: å„SNSã®å…¬å¼ã‚·ã‚§ã‚¢APIã‚’ä½¿ç”¨

#### 4. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- **ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ä¿å­˜**: ãƒ–ãƒ©ã‚¦ã‚¶ã®æ¨™æº–ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- **è‡ªå‹•ãƒ•ã‚¡ã‚¤ãƒ«å**: æ—¥æ™‚ä»˜ãã®åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ•ã‚¡ã‚¤ãƒ«å
- **å±¥æ­´ç®¡ç†**: ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å±¥æ­´ã®è¨˜éŒ²ã¨è¡¨ç¤º

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User Interface â”‚    â”‚  Business Logic   â”‚    â”‚  External APIs  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ SharePanel    â”‚â—„â”€â”€â–ºâ”‚ â€¢ useShare Hook   â”‚â—„â”€â”€â–ºâ”‚ â€¢ html2canvas   â”‚
â”‚ â€¢ ActionButtons â”‚    â”‚ â€¢ shareUtils      â”‚    â”‚ â€¢ Twitter API   â”‚
â”‚ â€¢ Preview Modal â”‚    â”‚ â€¢ imageGenerator  â”‚    â”‚ â€¢ Facebook API  â”‚
â”‚                 â”‚    â”‚ â€¢ errorHandling   â”‚    â”‚ â€¢ LINE API      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ 

#### 1. ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ (UI Components)
- **SharePanel**: ãƒ¡ã‚¤ãƒ³ã®ã‚·ã‚§ã‚¢ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **ActionButtons**: ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ã®çµ±åˆ
- **Preview Modal**: ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³

#### 2. ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ (Hooks & Utilities)
- **useShare**: çŠ¶æ…‹ç®¡ç†ã¨ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- **shareUtils**: SNSçµ±åˆã¨ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ
- **imageGenerator**: ç”»åƒç”Ÿæˆã¨ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯

#### 3. ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ (External APIs)
- **html2canvas**: DOMè¦ç´ ã®ç”»åƒå¤‰æ›
- **SNS APIs**: ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥ã‚·ã‚§ã‚¢æ©Ÿèƒ½
- **Browser APIs**: ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ 

## ğŸ”§ å®Ÿè£…è©³ç´°

### å‹å®šç¾©æ§‹é€ 

```typescript
// ä¸­æ ¸çš„ãªå‹å®šç¾©
interface ShareData {
  imageDataUrl: string;      // Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒãƒ‡ãƒ¼ã‚¿
  title: string;             // ã‚·ã‚§ã‚¢ç”¨ã‚¿ã‚¤ãƒˆãƒ«
  description: string;       // èª¬æ˜æ–‡
  hashtags: string[];        // ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°é…åˆ—
  stats?: SharePetStats;     // ãƒšãƒƒãƒˆçµ±è¨ˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
}

interface ScreenshotOptions {
  width?: number;            // ç”»åƒå¹…ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1080ï¼‰
  height?: number;           // ç”»åƒé«˜ã•ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1080ï¼‰
  quality?: number;          // å“è³ª 0-1ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1ï¼‰
  showWatermark?: boolean;   // ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯è¡¨ç¤º
  backgroundColor?: string;  // èƒŒæ™¯è‰²
  scale?: number;            // æ‹¡å¤§ç‡ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 2ï¼‰
}

interface StatsCardData {
  petName: string;           // ãƒšãƒƒãƒˆå
  level: number;             // ãƒ¬ãƒ™ãƒ«
  evolutionStage: string;    // é€²åŒ–æ®µéš
  totalPlayTime: number;     // ç·ãƒ—ãƒ¬ã‚¤æ™‚é–“
  gameWinRate: number;       // ã‚²ãƒ¼ãƒ å‹ç‡
  achievementCount: number;  // é”æˆæ•°
  specialTitle?: string;     // ç‰¹åˆ¥ç§°å·
  birthDate: Date;           // èª•ç”Ÿæ—¥
}
```

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆéšå±¤

```
App
â”œâ”€â”€ ActionButtons
â”‚   â””â”€â”€ Share Button (ã‚·ã‚§ã‚¢ãƒ‘ãƒãƒ«èµ·å‹•)
â””â”€â”€ SharePanel (isOpen={sharePanel})
    â”œâ”€â”€ ModeSelector (ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/çµ±è¨ˆã‚«ãƒ¼ãƒ‰)
    â”œâ”€â”€ ImagePreview (ç”Ÿæˆç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼)
    â”œâ”€â”€ SocialButtons (Twitter, Facebook, Instagram, LINE)
    â”œâ”€â”€ DownloadButton (ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰)
    â””â”€â”€ ErrorDisplay (ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º)
```

### çŠ¶æ…‹ç®¡ç†ãƒ•ãƒ­ãƒ¼

```typescript
// useShareãƒ•ãƒƒã‚¯ã®çŠ¶æ…‹ç®¡ç†
const useShare = () => {
  const [isSharing, setIsSharing] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [lastShareImageUrl, setLastShareImageUrl] = useState<string | null>(null);
  const [shareHistory, setShareHistory] = useState<ShareHistoryEntry[]>([]);
  
  // æ©Ÿèƒ½å®Ÿè£…...
};
```

## ğŸ“š APIä»•æ§˜

### useShare Hook

#### ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰

```typescript
interface UseShareReturn {
  // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±
  captureScreenshot: (
    element: HTMLElement, 
    options?: ScreenshotOptions
  ) => Promise<string>;
  
  // SNSã‚·ã‚§ã‚¢å®Ÿè¡Œ
  shareToSocial: (options: SocialShareOptions) => Promise<ShareResult>;
  
  // ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  downloadImage: (dataUrl: string, filename?: string) => void;
  
  // çµ±è¨ˆã‚«ãƒ¼ãƒ‰ç”Ÿæˆ
  generateStatsCard: (
    statsData: StatsCardData, 
    config?: ImageGenerationConfig
  ) => Promise<string>;
  
  // ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯è¿½åŠ 
  addWatermark: (
    imageDataUrl: string, 
    config?: WatermarkConfig
  ) => Promise<string>;
  
  // çŠ¶æ…‹ã¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
  isSharing: boolean;
  error: string | null;
  lastShareImageUrl: string | null;
  shareHistory: ShareHistoryEntry[];
  clearError: () => void;
  clearHistory: () => void;
}
```

#### ä½¿ç”¨ä¾‹

```typescript
// åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•
const ShareComponent = () => {
  const {
    captureScreenshot,
    shareToSocial,
    downloadImage,
    generateStatsCard,
    isSharing,
    error
  } = useShare();

  // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±
  const handleCapture = async () => {
    try {
      const imageUrl = await captureScreenshot(targetRef.current, {
        width: 1080,
        height: 1080,
        showWatermark: true
      });
      console.log('æ’®å½±å®Œäº†:', imageUrl);
    } catch (err) {
      console.error('æ’®å½±å¤±æ•—:', err);
    }
  };

  // SNSã‚·ã‚§ã‚¢
  const handleShare = async (platform: SocialPlatform) => {
    const shareData = {
      imageDataUrl: lastShareImageUrl,
      title: 'My AI Pet Buddy',
      description: 'ã‹ã‚ã„ã„ãƒšãƒƒãƒˆã¨éŠã‚“ã§ã„ã¾ã™ï¼',
      hashtags: ['#AIPetBuddy', '#VirtualPet']
    };

    const result = await shareToSocial({ platform, shareData });
    if (result.success) {
      console.log('ã‚·ã‚§ã‚¢æˆåŠŸ:', result.shareUrl);
    }
  };
};
```

### shareUtils API

#### ä¸»è¦é–¢æ•°

```typescript
// SNSã‚·ã‚§ã‚¢å®Ÿè¡Œ
export const shareToSocial = async (
  options: SocialShareOptions
): Promise<ShareResult> => {
  // ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥URLç”Ÿæˆã¨ã‚·ã‚§ã‚¢å®Ÿè¡Œ
};

// ãƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆ
export const generateFileName = (
  prefix: string = 'pet-buddy',
  extension: string = 'png'
): string => {
  // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆ
};

// ã‚·ã‚§ã‚¢ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
export const generateShareText = (
  shareData: ShareData,
  platform: SocialPlatform
): string => {
  // ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥æœ€é©åŒ–ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
};

// ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
export const downloadImage = (
  dataUrl: string,
  filename?: string
): void => {
  // ãƒ–ãƒ©ã‚¦ã‚¶ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ
};
```

### imageGenerator API

#### ä¸»è¦é–¢æ•°

```typescript
// DOMè¦ç´ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
export const captureElement = async (
  element: HTMLElement,
  options: ScreenshotOptions = {}
): Promise<string> => {
  // html2canvasã‚’ä½¿ç”¨ã—ãŸé«˜å“è³ªã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
};

// çµ±è¨ˆã‚«ãƒ¼ãƒ‰ç”Ÿæˆ
export const generateStatsCard = async (
  statsData: StatsCardData,
  config: ImageGenerationConfig = {}
): Promise<string> => {
  // å‹•çš„çµ±è¨ˆã‚«ãƒ¼ãƒ‰ç”Ÿæˆ
};

// ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯è¿½åŠ 
export const addWatermark = async (
  imageDataUrl: string,
  config: WatermarkConfig = DEFAULT_WATERMARK_CONFIG
): Promise<string> => {
  // Canvas APIã‚’ä½¿ç”¨ã—ãŸã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯æŒ¿å…¥
};
```

## ğŸ’¡ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

#### 1. ã‚·ã‚§ã‚¢ãƒ‘ãƒãƒ«ã®èµ·å‹•

```typescript
// ActionButtonsã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…
const handleShareClick = () => {
  setSharePanelOpen(true);
};

<button onClick={handleShareClick} className="action-button share-button">
  <FaShare /> Share
</button>
```

#### 2. ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±

```typescript
// SharePanelã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…
const handleCaptureScreenshot = async () => {
  if (!captureTargetRef.current) return;
  
  try {
    const imageUrl = await captureScreenshot(captureTargetRef.current, {
      width: 1080,
      height: 1080,
      showWatermark: true,
      quality: 1.0
    });
    setShareImageUrl(imageUrl);
  } catch (error) {
    console.error('Screenshot failed:', error);
  }
};
```

#### 3. çµ±è¨ˆã‚«ãƒ¼ãƒ‰ç”Ÿæˆ

```typescript
const handleGenerateStatsCard = async () => {
  if (!statsData) return;
  
  try {
    const cardImageUrl = await generateStatsCard(statsData, {
      watermark: {
        text: 'AI Pet Buddy',
        position: 'bottom-right',
        opacity: 0.7
      },
      format: 'png'
    });
    setShareImageUrl(cardImageUrl);
  } catch (error) {
    console.error('Stats card generation failed:', error);
  }
};
```

#### 4. SNSã‚·ã‚§ã‚¢å®Ÿè¡Œ

```typescript
const handleSocialShare = async (platform: SocialPlatform) => {
  if (!shareImageUrl) return;
  
  const shareData = generateShareData(shareImageUrl, statsData);
  
  try {
    const result = await shareToSocial({ platform, shareData });
    if (result.success) {
      alert('ã‚·ã‚§ã‚¢ãŒå®Œäº†ã—ã¾ã—ãŸï¼');
    } else {
      alert(`ã‚·ã‚§ã‚¢ã«å¤±æ•—ã—ã¾ã—ãŸ: ${result.error}`);
    }
  } catch (error) {
    console.error('Share failed:', error);
  }
};
```

#### 5. ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```typescript
const handleDownload = () => {
  if (!shareImageUrl) return;
  
  const filename = generateFileName('ai-pet-buddy', 'png');
  downloadImage(shareImageUrl, filename);
};
```

### é«˜åº¦ãªä½¿ç”¨ä¾‹

#### ã‚«ã‚¹ã‚¿ãƒ ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯

```typescript
const customWatermark: WatermarkConfig = {
  text: 'My Custom Brand',
  position: 'top-left',
  opacity: 0.5,
  fontSize: '14px',
  color: '#ff6b6b'
};

const watermarkedImage = await addWatermark(originalImage, customWatermark);
```

#### é«˜è§£åƒåº¦ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

```typescript
const highResOptions: ScreenshotOptions = {
  width: 2160,    // 4Kè§£åƒåº¦
  height: 2160,
  scale: 3,       // 3å€ã‚¹ã‚±ãƒ¼ãƒ«
  quality: 1.0,   // æœ€é«˜å“è³ª
  backgroundColor: '#ffffff'
};

const imageUrl = await captureScreenshot(element, highResOptions);
```

#### è¤‡æ•°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åŒæ™‚ã‚·ã‚§ã‚¢

```typescript
const platforms: SocialPlatform[] = ['twitter', 'facebook', 'line'];

const shareResults = await Promise.allSettled(
  platforms.map(platform => 
    shareToSocial({ platform, shareData })
  )
);

shareResults.forEach((result, index) => {
  if (result.status === 'fulfilled' && result.value.success) {
    console.log(`${platforms[index]} ã‚·ã‚§ã‚¢æˆåŠŸ`);
  } else {
    console.log(`${platforms[index]} ã‚·ã‚§ã‚¢å¤±æ•—`);
  }
});
```

## âš ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã¨å¯¾å‡¦æ³•

#### 1. ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±ã‚¨ãƒ©ãƒ¼

```typescript
// ä¸€èˆ¬çš„ãªã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹
try {
  const imageUrl = await captureScreenshot(element, options);
} catch (error) {
  if (error.message.includes('html2canvas')) {
    // html2canvasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¨ãƒ©ãƒ¼
    console.error('Canvas rendering failed:', error);
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ç°¡æ˜“ç‰ˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
  } else if (error.message.includes('element not found')) {
    // è¦ç´ ãŒå­˜åœ¨ã—ãªã„
    console.error('Target element not found');
    // UIè­¦å‘Šè¡¨ç¤º
  } else {
    // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼
    console.error('Unknown screenshot error:', error);
  }
}
```

#### 2. SNSã‚·ã‚§ã‚¢ã‚¨ãƒ©ãƒ¼

```typescript
// ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
const handleShareError = (platform: SocialPlatform, error: string) => {
  switch (platform) {
    case 'instagram':
      return 'Instagramã¯Webã‹ã‚‰ã®ç›´æ¥æŠ•ç¨¿ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¢ãƒ—ãƒªã‹ã‚‰æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚';
    case 'twitter':
      return 'Twitterã®ã‚·ã‚§ã‚¢ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚';
    case 'facebook':
      return 'Facebookã®ã‚·ã‚§ã‚¢ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
    default:
      return `${platform}ã®ã‚·ã‚§ã‚¢ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error}`;
  }
};
```

#### 3. ç”»åƒç”Ÿæˆã‚¨ãƒ©ãƒ¼

```typescript
// çµ±è¨ˆã‚«ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼
try {
  const cardImage = await generateStatsCard(statsData, config);
} catch (error) {
  if (error.message.includes('insufficient data')) {
    // ãƒ‡ãƒ¼ã‚¿ä¸è¶³
    alert('çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚ãƒšãƒƒãƒˆã¨ã®éŠã³æ™‚é–“ã‚’å¢—ã‚„ã—ã¦ãã ã•ã„ã€‚');
  } else if (error.message.includes('memory')) {
    // ãƒ¡ãƒ¢ãƒªä¸è¶³
    alert('ãƒ¡ãƒ¢ãƒªä¸è¶³ã§ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã‚’å†èµ·å‹•ã—ã¦ãŠè©¦ã—ãã ã•ã„ã€‚');
  } else {
    // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼
    console.error('Stats card generation error:', error);
  }
}
```

### ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®ç®¡ç†

```typescript
// useShareãƒ•ãƒƒã‚¯å†…ã§ã®ã‚¨ãƒ©ãƒ¼ç®¡ç†
const [error, setError] = useState<string | null>(null);

const clearError = useCallback(() => {
  setError(null);
}, []);

// ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const ErrorDisplay = ({ error, onClear }: { error: string | null, onClear: () => void }) => {
  if (!error) return null;
  
  return (
    <div className="error-display">
      <span>{error}</span>
      <button onClick={onClear}>Ã—</button>
    </div>
  );
};
```

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### æœ€é©åŒ–æˆ¦ç•¥

#### 1. ç”»åƒç”Ÿæˆã®æœ€é©åŒ–

```typescript
// é…å»¶èª­ã¿è¾¼ã¿ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥
const [imageCache, setImageCache] = useState<Map<string, string>>(new Map());

const getCachedImage = useCallback(async (key: string, generator: () => Promise<string>) => {
  if (imageCache.has(key)) {
    return imageCache.get(key)!;
  }
  
  const imageUrl = await generator();
  setImageCache(prev => new Map(prev).set(key, imageUrl));
  return imageUrl;
}, [imageCache]);
```

#### 2. DOMæ“ä½œã®æœ€å°åŒ–

```typescript
// çµ±è¨ˆã‚«ãƒ¼ãƒ‰ç”Ÿæˆæ™‚ã®åŠ¹ç‡çš„ãªDOMæ“ä½œ
const generateStatsCard = async (statsData: StatsCardData) => {
  // äº‹å‰ã«HTMLæ–‡å­—åˆ—ã‚’æ§‹ç¯‰
  const htmlContent = `
    <div class="stats-card">
      <h2>${statsData.petName}</h2>
      <div class="stats-grid">
        ${statsData.achievements.map(achievement => 
          `<div class="stat-item">${achievement}</div>`
        ).join('')}
      </div>
    </div>
  `;
  
  // ä¸€åº¦ã ã‘DOMæŒ¿å…¥
  const container = document.createElement('div');
  container.innerHTML = htmlContent;
  
  // ç”»åƒç”Ÿæˆå¾Œå³åº§ã«å‰Šé™¤
  document.body.appendChild(container);
  const imageUrl = await html2canvas(container).then(canvas => canvas.toDataURL());
  document.body.removeChild(container);
  
  return imageUrl;
};
```

#### 3. éåŒæœŸå‡¦ç†ã®æœ€é©åŒ–

```typescript
// ä¸¦åˆ—å‡¦ç†ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
const generateMultipleFormats = async (element: HTMLElement) => {
  const [pngImage, jpegImage, webpImage] = await Promise.all([
    captureElement(element, { format: 'png' }),
    captureElement(element, { format: 'jpeg', quality: 0.8 }),
    captureElement(element, { format: 'webp', quality: 0.8 })
  ]);
  
  return { pngImage, jpegImage, webpImage };
};
```

### ãƒ¡ãƒ¢ãƒªç®¡ç†

```typescript
// URLã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
useEffect(() => {
  return () => {
    // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆæ™‚ã«URLã‚’è§£æ”¾
    if (lastShareImageUrl && lastShareImageUrl.startsWith('blob:')) {
      URL.revokeObjectURL(lastShareImageUrl);
    }
  };
}, [lastShareImageUrl]);
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬

```typescript
// å‡¦ç†æ™‚é–“ã®è¨ˆæ¸¬
const measurePerformance = async <T>(
  operation: () => Promise<T>,
  operationName: string
): Promise<T> => {
  const startTime = performance.now();
  try {
    const result = await operation();
    const endTime = performance.now();
    console.log(`${operationName} completed in ${endTime - startTime}ms`);
    return result;
  } catch (error) {
    const endTime = performance.now();
    console.error(`${operationName} failed after ${endTime - startTime}ms:`, error);
    throw error;
  }
};

// ä½¿ç”¨ä¾‹
const captureWithTiming = () => measurePerformance(
  () => captureScreenshot(element, options),
  'Screenshot capture'
);
```

## ğŸš€ ä»Šå¾Œã®æ‹¡å¼µ

### è¨ˆç”»ä¸­ã®æ©Ÿèƒ½

#### 1. é«˜åº¦ãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ **: è¤‡æ•°ã®çµ±è¨ˆã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³
- **ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã®ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
- **ãƒ•ã‚©ãƒ³ãƒˆé¸æŠ**: ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚©ãƒ³ãƒˆã¨Webãƒ•ã‚©ãƒ³ãƒˆå¯¾å¿œ

#### 2. SNSæ©Ÿèƒ½æ‹¡å¼µ
- **Discordçµ±åˆ**: ã‚µãƒ¼ãƒãƒ¼åˆ¥ã‚·ã‚§ã‚¢æ©Ÿèƒ½
- **Redditå¯¾å¿œ**: ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æŠ•ç¨¿æ©Ÿèƒ½
- **TikToké€£æº**: çŸ­å‹•ç”»å½¢å¼ã®ã‚·ã‚§ã‚¢

#### 3. é«˜åº¦ãªç”»åƒå‡¦ç†
- **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³GIF**: ãƒšãƒƒãƒˆã®å‹•ãã‚’å«ã‚€ã‚·ã‚§ã‚¢
- **ARåŠ¹æœ**: æ‹¡å¼µç¾å®Ÿè¦ç´ ã®è¿½åŠ 
- **AIç”»åƒå¼·åŒ–**: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç”»è³ªå‘ä¸Š

#### 4. åˆ†æãƒ»çµ±è¨ˆæ©Ÿèƒ½
- **ã‚·ã‚§ã‚¢åˆ†æ**: ã©ã®çµ±è¨ˆãŒæœ€ã‚‚äººæ°—ã‹ã®åˆ†æ
- **ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆè¿½è·¡**: SNSã§ã®åéŸ¿æ¸¬å®š
- **A/Bãƒ†ã‚¹ãƒˆ**: ç•°ãªã‚‹ã‚·ã‚§ã‚¢å½¢å¼ã®åŠ¹æœæ¯”è¼ƒ

### æŠ€è¡“çš„æ”¹å–„ç‚¹

#### 1. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
```typescript
// Web Workersã‚’ä½¿ç”¨ã—ãŸãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†
const generateStatsCardInWorker = async (statsData: StatsCardData) => {
  const worker = new Worker('/workers/statsCardGenerator.js');
  
  return new Promise<string>((resolve, reject) => {
    worker.postMessage({ statsData });
    worker.onmessage = (e) => {
      if (e.data.success) {
        resolve(e.data.imageUrl);
      } else {
        reject(new Error(e.data.error));
      }
      worker.terminate();
    };
  });
};
```

#### 2. ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ
```typescript
// Service Workerã«ã‚ˆã‚‹ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½
const enableOfflineSharing = () => {
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').then(() => {
      console.log('Offline sharing enabled');
    });
  }
};
```

#### 3. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š
```typescript
// è¦–è¦šéšœå®³è€…å‘ã‘ã®ç”»åƒèª¬æ˜ç”Ÿæˆ
const generateImageAltText = (statsData: StatsCardData): string => {
  return `${statsData.petName}ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ãƒ¬ãƒ™ãƒ«${statsData.level}ã€` +
         `${statsData.evolutionStage}æ®µéšã€ãƒ—ãƒ¬ã‚¤æ™‚é–“${statsData.totalPlayTime}åˆ†ã€` +
         `å®Ÿç¸¾${statsData.achievementCount}å€‹é”æˆ`;
};
```

#### 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–
```typescript
// ç”»åƒãƒ‡ãƒ¼ã‚¿ã®å®‰å…¨ãªå‡¦ç†
const sanitizeImageData = (imageDataUrl: string): string => {
  // ãƒ‡ãƒ¼ã‚¿URLã®æ¤œè¨¼
  if (!imageDataUrl.startsWith('data:image/')) {
    throw new Error('Invalid image data format');
  }
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™
  const base64Data = imageDataUrl.split(',')[1];
  const imageSize = (base64Data.length * 3) / 4; // ãƒã‚¤ãƒˆæ•°è¨ˆç®—
  if (imageSize > 5 * 1024 * 1024) { // 5MBåˆ¶é™
    throw new Error('Image size too large');
  }
  
  return imageDataUrl;
};
```

---

## ğŸ“ ã¾ã¨ã‚

AI Pet Buddyã®ã‚·ã‚§ã‚¢æ©Ÿèƒ½ã¯ã€ç¾ä»£ã®ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ¡ãƒ‡ã‚£ã‚¢ç’°å¢ƒã«æœ€é©åŒ–ã•ã‚ŒãŸåŒ…æ‹¬çš„ãªã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚é«˜å“è³ªãªç”»åƒç”Ÿæˆã€å¤šæ§˜ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒƒãƒˆã¨ã®ä½“é¨“ã‚’ç°¡å˜ã«å…±æœ‰ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

### ä¸»è¦ãªç‰¹å¾´

1. **æŠ€è¡“çš„å„ªç§€æ€§**: html2canvasã€Canvas APIã€SNS APIã®åŠ¹æœçš„ãªçµ„ã¿åˆã‚ã›
2. **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**: ç›´æ„Ÿçš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
3. **æ‹¡å¼µæ€§**: ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼è¨­è¨ˆã«ã‚ˆã‚‹å°†æ¥çš„ãªæ©Ÿèƒ½è¿½åŠ ã¸ã®å¯¾å¿œ
4. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: æœ€é©åŒ–ã•ã‚ŒãŸéåŒæœŸå‡¦ç†ã¨ãƒ¡ãƒ¢ãƒªç®¡ç†

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒé–‹ç™ºè€…ã®ç†è§£ä¿ƒé€²ã¨åŠ¹ç‡çš„ãªé–‹ç™ºãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä½œæ¥­ã«è²¢çŒ®ã™ã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚